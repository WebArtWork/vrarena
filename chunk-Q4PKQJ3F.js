import{a as T}from"./chunk-LZ7H2IAM.js";import{b as N,e as U}from"./chunk-QVDMXOLA.js";import{Ab as F,Bb as L,Ia as b,J as c,M as s,N as k,O as C,R as y,T as p,Va as x,X as n,Y as o,Za as E,a as d,aa as g,b as h,ba as a,ca as v,hb as M,ib as j,ka as w,nb as P,qb as l,rb as V,s as I,x as _,y as f}from"./chunk-ML3SWCJJ.js";function J(t,B){if(t&1){let e=g();n(0,"span",8),a("click",function(){_(e);let i=v();return f(i.us.setMode("dark"))}),w(1," light_mode "),o()}}function O(t,B){if(t&1){let e=g();n(0,"span",8),a("click",function(){_(e);let i=v();return f(i.us.setMode("white"))}),w(1," dark_mode "),o()}}var q=(()=>{class t{constructor(e,r,i,u,D,R,A){this.us=e,this.ui=r,this._alert=i,this._http=u,this._router=D,this._form=R,this._translate=A,this.form=this._form.getForm("sign",{formId:"sign",title:"Sign In / Sign Up",components:[{name:"Email",key:"email",focused:!0,required:!0,fields:[{name:"Placeholder",value:"Enter your email"},{name:"Label",value:"Email"}]},{name:"Password",key:"password",required:!0,fields:[{name:"Placeholder",value:"Enter your password"},{name:"Label",value:"Password"}]},{name:"Number",key:"resetPin",fields:[{name:"Placeholder",value:"Enter code from email"},{name:"Label",value:"code"}],hidden:!0},{name:"Button",fields:[{name:"Label",value:"Let's go"},{name:"Click",value:()=>{this.submit()}}]}]}),this.user={email:l.sign.email,password:l.sign.password,resetPin:null},this._set=m=>{if(m){let S=m.token||"";S&&this._http.set("token",S),localStorage.setItem("waw_user",JSON.stringify(m)),this.us.setUser(m),this.us.get(),console.log(localStorage.getItem("waw_redirect")),this._router.navigateByUrl(localStorage.getItem("waw_redirect")||"/games"),localStorage.removeItem("waw_redirect")}else this._alert.error({text:"Something went wrong"})}}submit(){!this.form.components[2].hidden&&this.user.resetPin?this.save():this.user.email||this._alert.error({text:this._translate.translate("Sign.Enter your email")}),this.ui.valid(this.user.email)?this.user.password?this._http.post("/api/user/status",this.user,e=>{e.email&&e.pass?this.login():e.email?this.reset():this.sign()}):this._alert.error({text:this._translate.translate("Sign.Enter your password")}):this._alert.error({text:this._translate.translate("Sign.Enter proper email")})}login(){this._http.post("/api/user/login",h(d({},this.user),{appId:l.appId}),this._set.bind(this))}sign(){this._http.post("/api/user/sign",h(d({},this.user),{appId:l.appId}),this._set.bind(this))}reset(){this._http.post("/api/user/request",this.user,()=>{this.form.components[2].hidden=!1}),this._alert.info({text:"Mail will sent to your email"})}save(){this._http.post("/api/user/change",this.user,e=>{e?this._alert.info({text:"Password successfully changed"}):this._alert.error({text:"Wrong Code"}),this.login()})}static{this.\u0275fac=function(r){return new(r||t)(s(T),s(P),s(j),s(M),s(x),s(F),s(V))}}static{this.\u0275cmp=k({type:t,selectors:[["ng-component"]],standalone:!1,decls:9,vars:4,consts:[[1,"auth-wrapper"],[1,"auth__wrap"],[1,"auth__img"],[3,"click"],[1,"auth__form"],[1,"auth"],["class","material-icons auth__icon",3,"click",4,"ngIf"],[3,"wSubmit","submition","config"],[1,"material-icons","auth__icon",3,"click"]],template:function(r,i){r&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"vrglass-icon",3),a("click",function(){return i.us.setMode(i.us.mode==="dark"?"white":"dark")}),o()(),n(4,"div",4)(5,"div",5),y(6,J,2,0,"span",6)(7,O,2,0,"span",6),n(8,"wform",7),a("wSubmit",function(){return i.submit()}),o()()()()()),r&2&&(c(6),p("ngIf",i.us.mode==="white"),c(),p("ngIf",i.us.mode==="dark"),c(),p("submition",i.user)("config",i.form))},dependencies:[b,L,N],encapsulation:2})}}return t})();var W=[{path:"",component:q}],oe=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=C({type:t})}static{this.\u0275inj=I({imports:[E.forChild(W),U]})}}return t})();export{oe as SignModule};
